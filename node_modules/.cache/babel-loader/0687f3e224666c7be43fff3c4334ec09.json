{"ast":null,"code":"import _slicedToArray from\"/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n:hover{\\n\\t/* background-color:#b4e7fc; */\\n  background-color: \",\"\\n};\\nbackground-color: \",\";\\nopacity : \",\";;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\nmargin: 1%;\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\nmargin: 1%;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  /* background: #d1d3a2; */\\n  /* background: #d1dfff; */\\n  background: #282c34;\\n  overflow:auto;\\n  /* height: 800px; */\\n  /* height: 83vh; */\\n  margin-top:10px;\\n\\n  /* flex: 0 1 auto \\u5C45\\u7136\\u6548\\u679C\\u4E00\\u6837 */\\n  flex: 1 1 auto;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  width:100px;\\n  display:inline-block;\\n  text-align:center;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  /* background: #d1d3a2; */\\n  /* background: #d1dfff; */\\n  background: #282c34;\\n  height: 100vh;\\n\\n  display: flex;\\n  flex-direction: column;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect}from'react';import styled from'styled-components';import{Input,message,Switch,Button,Row,Col,List,Dropdown,Menu,Modal,DatePicker}from'antd';// 这样居然真的行\n// import { DateType } from 'antd/lib/date-picker';\nimport{DownOutlined}from'@ant-design/icons';import stores from'../stores';import{StoreModel}from'../model/model';import Utils from'../utils/Utils';import DateUtils from'../utils/DateUtils';import TaskInfoFormat from'../utils/TaskInfoFormat';import Format from'../utils/Format';import{Task,CycleRecord}from'../model/model';import{CurrentTaskKey}from'../stores/CurrentTaskStore';import{CurrentDoingTaskKey}from'../stores/CurrentDoingTaskStore';import{CurrentDayOffsetKey}from'../stores/CurrentDayOffsetStore';import'antd/dist/antd.css';import{plainToClass}from\"class-transformer\";import moment from'moment';var Container=styled.div(_templateObject());var Div=styled.div(_templateObject2());var ParamTag=styled.span(_templateObject3());var Container2=styled.div(_templateObject4());var InputGroup=styled(Input.Group)(_templateObject5());var ButtonGroup=styled(Button.Group)(_templateObject6());var TaskListContainer=function TaskListContainer(){var _ref=stores.useStore('mainmodel'),storeModel=_ref.storeModel,save=_ref.save,setModel=_ref.setModel;var _ref2=stores.useStore(CurrentDayOffsetKey),currentDayOffset=_ref2.currentDayOffset,setCurrentDayOffset=_ref2.setCurrentDayOffset;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isNeedExceptTime=_useState4[0],setNeedExceptTimeUI=_useState4[1];var _useState5=useState(2),_useState6=_slicedToArray(_useState5,2),expectTime=_useState6[0],setExpectTime=_useState6[1];var _useState7=useState(3),_useState8=_slicedToArray(_useState7,2),level=_useState8[0],setLevel=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isCycleTask=_useState10[0],setCycleTaskUI=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),cycleGap=_useState12[0],setCycleGap=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isLongTask=_useState14[0],setLongTaskUI=_useState14[1];var _useState15=useState(3),_useState16=_slicedToArray(_useState15,2),exceptWorkday=_useState16[0],setExceptWorkday=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),exceptHoliDay=_useState18[0],setExceptHoliDay=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),isStartNow=_useState20[0],setStartNow=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),expectStartTime=_useState22[0],setExpectStartTime=_useState22[1];// React.useEffect(() => {\n//   console.log(\"TaskListContainer useEffect\")\n// },[])\nfunction setNeedExceptTime(isNeedExceptTime){if(!isNeedExceptTime&&isLongTask){message.error(\"长任务必须估时\");return;}setNeedExceptTimeUI(isNeedExceptTime);}function setCycleTask(isCycleTask){if(isCycleTask){setLongTask(false);}setCycleTaskUI(isCycleTask);}function setLongTask(isLongTask){if(isLongTask){setNeedExceptTime(true);setCycleTask(false);}setLongTaskUI(isLongTask);}function onAddTask(event){event.preventDefault();if(Utils.isStringEmpty(title)){message.error(\"请输入内容\");return;}if(isLongTask&&isCycleTask){message.error(\"不能同时是长任务和周期任务\");return;}if(isCycleTask){var newRecord=new CycleRecord();newRecord.init(cycleGap,title,level);if(!isStartNow&&expectStartTime!==null){newRecord.setStartTime(expectStartTime);}if(isNeedExceptTime){newRecord.expectConsumes=expectTime*3600*1000;// 单位小时，转换\n}else{newRecord.expectConsumes=-1;// 表示不设置时间\n}storeModel.addCycleRecord(newRecord);storeModel.normalUpdate();}else{var newTask=new Task();newTask.init(title);newTask.level=level;if(!isStartNow&&expectStartTime!==null){newTask.expectStartTime=expectStartTime;}if(isNeedExceptTime){newTask.expectConsumes.push(expectTime*3600*1000);// 单位小时，转换\n}else{newTask.expectConsumes.push(-1);// 表示不设置时间\n}storeModel.addTask(newTask);storeModel.normalUpdate();}save();setTitle(\"\");setExpectStartTime(null);}function changeOffsetDay(isAdd){if(isAdd){setCurrentDayOffset(currentDayOffset+1);}else{setCurrentDayOffset(currentDayOffset-1);}}function download(){Utils.downloadFile(\"DoingList_\".concat(Format.formatTimeInMsToFileName(Utils.getTimestamp()),\".dl\"),JSON.stringify(storeModel));}function upload(e){var file=e.target.files[0];console.log(file);var reader=new FileReader();reader.onload=function(){var uploadContent=this.result;if(typeof uploadContent==='string'){Modal.confirm({title:'确定要导入嘛？',content:\"\\u5BFC\\u5165\\u4F1A\\u8986\\u76D6\\u5F53\\u524D\\u6240\\u6709\\u4EFB\\u52A1\",onOk:function onOk(){Modal.confirm({title:'是否需要先下载当前任务？',content:\"\",onOk:function onOk(){download();setModel(plainToClass(StoreModel,JSON.parse(uploadContent)));},onCancel:function onCancel(){setModel(plainToClass(StoreModel,JSON.parse(uploadContent)));}});}});}else{message.error(\"导入文件有问题，导入失败\");}};//读取文件内容\nreader.readAsText(file);}function getOffsetString(){var base=\"\"+currentDayOffset;if(currentDayOffset>0){base=\"+\"+base;}return base;}function getAllTaskStatus(){var notDoneTasks=storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)).filter(function(task){return!task.isDone();});if(notDoneTasks.length===0){return\"\";}var consumeFormat=\"\";var consumes=notDoneTasks.map(function(task){var left=task.getLeftExpectConsumeTime();if(left<0)return 0;return left;}).reduce(function(a,b){return a+b;});// console.log(\"getAllTaskStatus\" + consumes)\nif(consumes>0){consumeFormat=\"\\uFF0C\\u603B\\u5269\\u4F59\\u9884\\u4F30\\u9700\\u8981\\u82B1\\u8D39\".concat(Format.formatDuration(consumes));}return\"\\u5171\".concat(notDoneTasks.length,\"\\u4E2A\\u4EFB\\u52A1\\u672A\\u5B8C\\u6210\").concat(consumeFormat);}function getMenu(){return/*#__PURE__*/React.createElement(Menu,{onClick:function onClick(param){return setLevel(Number(param.key));}},/*#__PURE__*/React.createElement(Menu.Item,{key:\"1\"},\"\\u4F18\\u5148\\u7EA7 1\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"2\"},\"\\u4F18\\u5148\\u7EA7 2\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"3\"},\"\\u4F18\\u5148\\u7EA7 3\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"4\"},\"\\u4F18\\u5148\\u7EA7 4\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"5\"},\"\\u4F18\\u5148\\u7EA7 5\"));}return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Div,{style:{flex:\"0 1 auto\"}},/*#__PURE__*/React.createElement(ButtonGroup,null,/*#__PURE__*/React.createElement(Button,{type:\"primary\",size:\"small\",onClick:function onClick(e){return changeOffsetDay(false);}},\"\\u2190\"),/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:\"#ffffff\",padding:4}},Format.formatTimeInDay(DateUtils.getMyCurrentDayStamp(currentDayOffset,DateUtils.dayOffset)),\"(\",getOffsetString(),\")\"),/*#__PURE__*/React.createElement(Button,{type:\"primary\",size:\"small\",onClick:function onClick(e){return changeOffsetDay(true);}},\"\\u2192\"),/*#__PURE__*/React.createElement(\"span\",{style:{paddingLeft:10}}),/*#__PURE__*/React.createElement(Button,{type:\"primary\",size:\"small\",onClick:function onClick(e){return download();}},\"\\u5BFC\\u51FA\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"upload-file\",multiple:true,onChange:function onChange(event){return upload(event);}}),/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:\"#ffffff\",padding:4}},\"\\u9700\\u5E73\\u8861\\u65F6\\u95F4\\uFF1A\",-storeModel.totalAdjustConsumeTime/(3600*1000),\"h\")),/*#__PURE__*/React.createElement(Row,{style:{margin:\"10px\"}},/*#__PURE__*/React.createElement(Col,{flex:\"1 1 auto\"},/*#__PURE__*/React.createElement(Input,{placeholder:\"\\u8F93\\u5165\\u4EFB\\u52A1\\uFF0C\\u56DE\\u8F66\\u6DFB\\u52A0\",value:title,onChange:function onChange(event){return setTitle(event.target.value);},onPressEnter:onAddTask})),/*#__PURE__*/React.createElement(Col,{flex:\"0 1 auto\"},/*#__PURE__*/React.createElement(Dropdown,{overlay:getMenu()},/*#__PURE__*/React.createElement(\"a\",{style:{paddingLeft:5},className:\"ant-dropdown-link\",onClick:function onClick(e){return e.preventDefault();}},formartLevel(level),\" \",/*#__PURE__*/React.createElement(DownOutlined,null))),isNeedExceptTime&&/*#__PURE__*/React.createElement(Input,{style:{width:'100px',marginLeft:\"15px\"},value:expectTime,placeholder:\"\\u82B1\\u8D39\\u65F6\\u95F4\",prefix:\"\\u9884\\u8BA1\",suffix:\"h\",onChange:function onChange(event){return setExpectTime(Number(event.target.value));}}),/*#__PURE__*/React.createElement(Switch,{style:{marginLeft:'5px',marginRight:'3px'},checkedChildren:\"\\u4F30\\u65F6\",unCheckedChildren:\"\\u4E0D\\u9650\",checked:isNeedExceptTime,onChange:function onChange(event){return setNeedExceptTime(event);}}),/*#__PURE__*/React.createElement(Switch,{style:{marginLeft:'5px',marginRight:'3px'},checkedChildren:\"\\u7ACB\\u523B\\u5F00\\u59CB\",unCheckedChildren:\"\\u4E4B\\u540E\\u5F00\\u59CB\",checked:isStartNow,onChange:function onChange(event){return setStartNow(event);}}),/*#__PURE__*/React.createElement(Switch,{style:{marginLeft:'5px',marginRight:'3px'},checkedChildren:\"\\u957F\\u4EFB\\u52A1\",unCheckedChildren:\"\\u77ED\\u4EFB\\u52A1\",checked:isLongTask,onChange:function onChange(event){return setLongTask(event);}}),/*#__PURE__*/React.createElement(Switch,{style:{marginLeft:'5px',marginRight:'3px'},checkedChildren:\"\\u5468\\u671F\",unCheckedChildren:\"\\u5355\\u4E2A\",checked:isCycleTask,onChange:function onChange(event){return setCycleTask(event);}}))),/*#__PURE__*/React.createElement(Div,{style:{margin:\"10px\",color:\"#ffffff\"}},!isStartNow&&/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:\"15px\"}},\"\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\",/*#__PURE__*/React.createElement(DatePicker,{showTime:true,value:expectStartTime,onOk:function onOk(value){return setExpectStartTime(moment(value.valueOf()));}})),isLongTask&&/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:\"15px\"}},\"\\u957F\\u4EFB\\u52A1\\uFF1A\",/*#__PURE__*/React.createElement(Input,{style:{width:'100px'},value:exceptWorkday,prefix:\"\\u8BA1\\u5212\",suffix:\"\\u5929\",onChange:function onChange(event){return setExceptWorkday(Number(event.target.value));}}),/*#__PURE__*/React.createElement(Input,{style:{width:'100px'},value:exceptHoliDay,prefix:\"\\u5047\\u671F\",suffix:\"\\u5929\",onChange:function onChange(event){return setExceptHoliDay(Number(event.target.value));}})),isCycleTask&&/*#__PURE__*/React.createElement(Input,{style:{width:'100px',marginLeft:\"15px\"},value:cycleGap,placeholder:\"1\\u8868\\u793A\\u4E0D\\u95F4\\u9694\",prefix:\"\\u6BCF\",suffix:\"\\u5929\",onChange:function onChange(event){return setCycleGap(Number(event.target.value));}})),/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:\"#ffffff\",padding:2,margin:\"10px\"}},getAllTaskStatus())),/*#__PURE__*/React.createElement(NoteList,null));};var NoteItem=styled.div(_templateObject7(),function(props){if(props.choosed){return'#f5b52b';}else{return'#b4e7fc';}},function(props){if(props.choosed){return'#f5b52b';}else{return'#ffffff';}},function(props){if(props.isDone){return 0.15;}else{return 1;}});var NoteList=function NoteList(){var _ref3=stores.useStore('mainmodel'),storeModel=_ref3.storeModel;var _ref4=stores.useStore(CurrentTaskKey),currentTask=_ref4.currentTask,setCurrentTask=_ref4.setCurrentTask;var _ref5=stores.useStore(CurrentDoingTaskKey),currentDoingTask=_ref5.currentDoingTask,setCurrentDoingTask=_ref5.setCurrentDoingTask;var _ref6=stores.useStore('mainmodel'),save=_ref6.save;var _ref7=stores.useStore(CurrentDayOffsetKey),currentDayOffset=_ref7.currentDayOffset,setCurrentDayOffset=_ref7.setCurrentDayOffset;useEffect(function(){// console.log(\"NoteList useEffect\")\nif(currentDoingTask===undefined){var doingTasks=storeModel.tasks.filter(function(value){return value.isDoing();});if(doingTasks.length===0){return;}if(doingTasks.length>1){console.error(\"\\u6709 \".concat(doingTasks.length,\" \\u4E2A\\u4EFB\\u52A1\\u5728\\u8FD0\\u884C\\u4E2D\\uFF0C\\u81EA\\u52A8\\u5173\\u95ED\"));for(var i=1;i<doingTasks.length;i++){doingTasks[i].stop();}}setCurrentDoingTask(doingTasks[0]);}});function onChooseNote(event,note){event.preventDefault();setCurrentTask(note);}var onClickMenu=function onClickMenu(param,task){task.level=Number(param.key);storeModel.normalUpdate();save();param.domEvent.preventDefault();// 怎么阻止对 parent 的点击事件\n// param.domEvent.stopPropagation()\n};function getMenu(task){return/*#__PURE__*/React.createElement(Menu,{onClick:function onClick(param){return onClickMenu(param,task);}},/*#__PURE__*/React.createElement(Menu.Item,{key:\"1\"},\"\\u4F18\\u5148\\u7EA7 1\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"2\"},\"\\u4F18\\u5148\\u7EA7 2\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"3\"},\"\\u4F18\\u5148\\u7EA7 3\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"4\"},\"\\u4F18\\u5148\\u7EA7 4\"),/*#__PURE__*/React.createElement(Menu.Item,{key:\"5\"},\"\\u4F18\\u5148\\u7EA7 5\"));}function startTask(event,task){if(task.isDone()){message.error(\"\\u4EFB\\u52A1\\u5DF2\\u5B8C\\u6210\\uFF0C\\u5B8C\\u6210\\u65F6\\u95F4:\".concat(Format.formatTimeInMs(task.doneTime)));return;}if(currentDoingTask!=undefined&&currentDoingTask.id===task.id){message.error(\"\\u4EFB\\u52A1\\u5DF2\\u7ECF\\u5728\\u8FDB\\u884C\\u4E2D\\uFF0C\\u4E0A\\u6B21\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\".concat(Format.formatTimeInMs(task.lastStartTime())));return;}if(task.isDoing()){// todo 自动恢复\nmessage.error(\"\\u4EFB\\u52A1\\u5F02\\u5E38\\u4E2D\\u65AD\\uFF0C\\u91CD\\u65B0\\u5F00\\u59CB\\u3002\\u4E0A\\u6B21\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\".concat(Format.formatTimeInMs(task.lastStartTime())));}if(currentDoingTask!=undefined){currentDoingTask.stop();}task.start();setCurrentDoingTask(task);storeModel.normalUpdate();save();}function getShowTips(task){var result=\"  \"+TaskInfoFormat.getDoingStatusTips(task)+TaskInfoFormat.getDeadline(task)+TaskInfoFormat.getConsumeExpected(task);return result;}return/*#__PURE__*/React.createElement(Container2,null,/*#__PURE__*/React.createElement(List,{size:\"small\",style:{backgroundColor:'white',margin:\"1%\"},bordered:true,dataSource:storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)),renderItem:function renderItem(task){return/*#__PURE__*/React.createElement(NoteItem,{choosed:task.isSameTask(currentTask),key:task.id,onClick:function onClick(e){return onChooseNote(e,task);},isDone:task.isDone(),onDoubleClick:function onDoubleClick(e){return startTask(e,task);}},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{flex:\"1 1 auto\"},/*#__PURE__*/React.createElement(NoteItemInput,{key:task.id,task:task})),/*#__PURE__*/React.createElement(Col,{flex:\"0 1 auto\"},getShowTips(task),/*#__PURE__*/React.createElement(Dropdown,{overlay:getMenu(task)},/*#__PURE__*/React.createElement(\"a\",{style:{paddingLeft:5},className:\"ant-dropdown-link\",onClick:function onClick(e){return e.preventDefault();}},formartLevel(task.level),\" \",/*#__PURE__*/React.createElement(DownOutlined,null))),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(e){return startTask(e,task);}},\"Start\"))));}}));};function formartLevel(level){switch(level){case 1:return\"🌟\";case 2:return\"🎏\";case 3:return\"3️⃣\";case 4:return\"4️\";case 5:return\"5️\";default:return\"\";}// switch (level) {\n//   case 1:\n//     return \"🥇\"\n//   case 2:\n//     return \"🥈\"\n//   case 3:\n//     return \"🥉\"\n//   case 4:\n//     return \"4️⃣\"\n//   case 5:\n//     return \"5️\"\n//   default:\n//     return \"\"\n// }\n}var NoteItemInput=function NoteItemInput(props){var _useState23=useState(props.task.title),_useState24=_slicedToArray(_useState23,2),content=_useState24[0],setContent=_useState24[1];var _ref8=stores.useStore('mainmodel'),save=_ref8.save;function saveTaskTitle(event){props.task.title=content;save();}return/*#__PURE__*/React.createElement(Input,{style:{background:\"#ffffff70\",fontWeight:\"bold\"},value:content,onChange:function onChange(e){return setContent(e.target.value);},onBlur:saveTaskTitle});};export default TaskListContainer;","map":{"version":3,"sources":["/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/src/layouts/TaskListContainer.tsx"],"names":["React","useState","useEffect","styled","Input","message","Switch","Button","Row","Col","List","Dropdown","Menu","Modal","DatePicker","DownOutlined","stores","StoreModel","Utils","DateUtils","TaskInfoFormat","Format","Task","CycleRecord","CurrentTaskKey","CurrentDoingTaskKey","CurrentDayOffsetKey","plainToClass","moment","Container","div","Div","ParamTag","span","Container2","InputGroup","Group","ButtonGroup","TaskListContainer","useStore","storeModel","save","setModel","currentDayOffset","setCurrentDayOffset","title","setTitle","isNeedExceptTime","setNeedExceptTimeUI","expectTime","setExpectTime","level","setLevel","isCycleTask","setCycleTaskUI","cycleGap","setCycleGap","isLongTask","setLongTaskUI","exceptWorkday","setExceptWorkday","exceptHoliDay","setExceptHoliDay","isStartNow","setStartNow","expectStartTime","setExpectStartTime","setNeedExceptTime","error","setCycleTask","setLongTask","onAddTask","event","preventDefault","isStringEmpty","newRecord","init","setStartTime","expectConsumes","addCycleRecord","normalUpdate","newTask","push","addTask","changeOffsetDay","isAdd","download","downloadFile","formatTimeInMsToFileName","getTimestamp","JSON","stringify","upload","e","file","target","files","console","log","reader","FileReader","onload","uploadContent","result","confirm","content","onOk","parse","onCancel","readAsText","getOffsetString","base","getAllTaskStatus","notDoneTasks","getTasks","getMyCurrentDayDur","filter","task","isDone","length","consumeFormat","consumes","map","left","getLeftExpectConsumeTime","reduce","a","b","formatDuration","getMenu","param","Number","key","flex","backgroundColor","padding","formatTimeInDay","getMyCurrentDayStamp","dayOffset","paddingLeft","totalAdjustConsumeTime","margin","value","formartLevel","width","marginLeft","marginRight","color","valueOf","NoteItem","props","choosed","NoteList","currentTask","setCurrentTask","currentDoingTask","setCurrentDoingTask","undefined","doingTasks","tasks","isDoing","i","stop","onChooseNote","note","onClickMenu","domEvent","startTask","formatTimeInMs","doneTime","id","lastStartTime","start","getShowTips","getDoingStatusTips","getDeadline","getConsumeExpected","isSameTask","NoteItemInput","setContent","saveTaskTitle","background","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Input, message, Switch, Button, Row, Col, List, Dropdown, Menu, Modal, DatePicker } from 'antd';\n// 这样居然真的行\nimport { ClickParam } from 'antd/lib/menu';\n// import { DateType } from 'antd/lib/date-picker';\nimport { DownOutlined } from '@ant-design/icons';\nimport stores from '../stores';\nimport { StoreModel, Duration } from '../model/model'\nimport Utils from '../utils/Utils'\nimport DateUtils from '../utils/DateUtils'\nimport TaskInfoFormat from '../utils/TaskInfoFormat'\nimport Format from '../utils/Format'\nimport { Task, Note, CycleRecord } from '../model/model'\nimport { CurrentTaskKey } from '../stores/CurrentTaskStore';\nimport { CurrentDoingTaskKey } from '../stores/CurrentDoingTaskStore';\nimport { CurrentDayOffsetKey } from '../stores/CurrentDayOffsetStore';\nimport 'antd/dist/antd.css';\nimport { plainToClass } from \"class-transformer\";\nimport moment from 'moment'\n\nconst Container = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n  height: 100vh;\n\n  display: flex;\n  flex-direction: column;\n`\n\nconst Div = styled.div`\n`\n\nconst ParamTag = styled.span`\n  width:100px;\n  display:inline-block;\n  text-align:center;\n`\n\nconst Container2 = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n  overflow:auto;\n  /* height: 800px; */\n  /* height: 83vh; */\n  margin-top:10px;\n\n  /* flex: 0 1 auto 居然效果一样 */\n  flex: 1 1 auto;\n`\n\nconst InputGroup = styled(Input.Group)`\nmargin: 1%;\n`\nconst ButtonGroup = styled(Button.Group)`\nmargin: 1%;\n`\n\nconst TaskListContainer: React.FC = () => {\n  const { storeModel, save, setModel } = stores.useStore('mainmodel') as { storeModel: StoreModel, save: () => void, setModel: (storeModel: StoreModel) => void };\n  const { currentDayOffset, setCurrentDayOffset } = stores.useStore(CurrentDayOffsetKey) as { currentDayOffset: number, setCurrentDayOffset: (offset: number) => void }\n  const [title, setTitle] = useState(\"\");\n  const [isNeedExceptTime, setNeedExceptTimeUI] = useState(true);\n  const [expectTime, setExpectTime] = useState(2);\n\n  const [level, setLevel] = useState(3);\n\n  const [isCycleTask, setCycleTaskUI] = useState(false);\n  const [cycleGap, setCycleGap] = useState(1);\n\n  const [isLongTask, setLongTaskUI] = useState(false);\n  const [exceptWorkday, setExceptWorkday] = useState(3);\n  const [exceptHoliDay, setExceptHoliDay] = useState(1);\n\n  const [isStartNow, setStartNow] = useState(true);\n  const [expectStartTime, setExpectStartTime] = useState<any>(null);\n\n  // React.useEffect(() => {\n  //   console.log(\"TaskListContainer useEffect\")\n  // },[])\n\n  function setNeedExceptTime(isNeedExceptTime: boolean) {\n    if (!isNeedExceptTime && isLongTask) {\n      message.error(\"长任务必须估时\")\n      return\n    }\n\n    setNeedExceptTimeUI(isNeedExceptTime)\n  }\n\n  function setCycleTask(isCycleTask: boolean) {\n    if (isCycleTask) {\n      setLongTask(false)\n    }\n\n    setCycleTaskUI(isCycleTask)\n  }\n\n  function setLongTask(isLongTask: boolean) {\n    if (isLongTask) {\n      setNeedExceptTime(true)\n      setCycleTask(false)\n    }\n\n    setLongTaskUI(isLongTask)\n  }\n\n  function onAddTask(event: any) {\n    event.preventDefault();\n\n    if (Utils.isStringEmpty(title)) {\n      message.error(\"请输入内容\")\n      return\n    }\n    if (isLongTask && isCycleTask) {\n      message.error(\"不能同时是长任务和周期任务\")\n      return\n    }\n\n    if (isCycleTask) {\n      const newRecord = new CycleRecord()\n      newRecord.init(cycleGap, title, level)\n\n      if (!isStartNow && expectStartTime !== null) {\n        newRecord.setStartTime(expectStartTime)\n      }\n\n      if (isNeedExceptTime) {\n        newRecord.expectConsumes = expectTime * 3600 * 1000 // 单位小时，转换\n      } else {\n        newRecord.expectConsumes = -1 // 表示不设置时间\n      }\n\n      storeModel.addCycleRecord(newRecord)\n      storeModel.normalUpdate()\n    } else {\n      const newTask = new Task()\n      newTask.init(title)\n      newTask.level = level\n\n      if (!isStartNow && expectStartTime !== null) {\n        newTask.expectStartTime = expectStartTime\n      }\n\n      if (isNeedExceptTime) {\n        newTask.expectConsumes.push(expectTime * 3600 * 1000) // 单位小时，转换\n      } else {\n        newTask.expectConsumes.push(-1) // 表示不设置时间\n      }\n\n      storeModel.addTask(newTask)\n      storeModel.normalUpdate()\n    }\n\n    save()\n\n    setTitle(\"\")\n    setExpectStartTime(null)\n  }\n\n  function changeOffsetDay(isAdd: boolean) {\n    if (isAdd) {\n      setCurrentDayOffset(currentDayOffset + 1)\n    } else {\n      setCurrentDayOffset(currentDayOffset - 1)\n    }\n  }\n\n  function download() {\n    Utils.downloadFile(`DoingList_${Format.formatTimeInMsToFileName(Utils.getTimestamp())}.dl`, JSON.stringify(storeModel))\n  }\n\n  function upload(e: any) {\n    let file = e.target.files[0];\n    console.log(file)\n\n    let reader = new FileReader();\n    reader.onload = function (this) {\n      let uploadContent = this.result\n      if (typeof uploadContent === 'string') {\n        Modal.confirm({\n          title: '确定要导入嘛？',\n          content: `导入会覆盖当前所有任务`,\n          onOk() {\n            Modal.confirm({\n              title: '是否需要先下载当前任务？',\n              content: ``,\n              onOk() {\n                download()\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent as string)))\n              },\n              onCancel() {\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent as string)))\n              }\n            });\n          },\n        })\n      } else {\n        message.error(\"导入文件有问题，导入失败\")\n      }\n    }\n    //读取文件内容\n    reader.readAsText(file);\n  }\n\n  function getOffsetString() {\n    let base = \"\" + currentDayOffset\n    if (currentDayOffset > 0) {\n      base = \"+\" + base\n    }\n    return base\n  }\n\n  function getAllTaskStatus(): string {\n    let notDoneTasks = storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)).filter((task) => { return !task.isDone() })\n\n    if (notDoneTasks.length === 0) {\n      return \"\"\n    }\n\n    let consumeFormat = \"\"\n    let consumes: number = notDoneTasks.map((task) => {\n      let left = task.getLeftExpectConsumeTime()\n      if (left < 0) return 0\n      return left\n    }).reduce((a, b) => a + b)\n\n    // console.log(\"getAllTaskStatus\" + consumes)\n    if (consumes > 0) {\n      consumeFormat = `，总剩余预估需要花费${Format.formatDuration(consumes)}`\n    }\n\n    return `共${notDoneTasks.length}个任务未完成${consumeFormat}`\n  }\n\n  function getMenu(): React.ReactElement {\n    return (\n      <Menu onClick={(param) => setLevel(Number(param.key))}>\n        <Menu.Item key=\"1\">优先级 1</Menu.Item>\n        <Menu.Item key=\"2\">优先级 2</Menu.Item>\n        <Menu.Item key=\"3\">优先级 3</Menu.Item>\n        <Menu.Item key=\"4\">优先级 4</Menu.Item>\n        <Menu.Item key=\"5\">优先级 5</Menu.Item>\n      </Menu>\n    )\n  }\n\n  return (\n    <Container>\n\n      <Div style={{ flex: \"0 1 auto\" }}>\n        <ButtonGroup>\n          <Button type=\"primary\" size=\"small\" onClick={(e) => changeOffsetDay(false)}>←</Button>\n\n          <span style={{ backgroundColor: \"#ffffff\", padding: 4 }} >\n            {Format.formatTimeInDay(DateUtils.getMyCurrentDayStamp(currentDayOffset, DateUtils.dayOffset))}({getOffsetString()})\n        </span>\n\n          <Button type=\"primary\" size=\"small\" onClick={(e) => changeOffsetDay(true)}>→</Button>\n          <span style={{ paddingLeft: 10 }} ></span>\n          <Button type=\"primary\" size=\"small\" onClick={(e) => download()}>导出</Button>\n          <input type=\"file\" id=\"upload-file\" multiple onChange={(event) => upload(event)} />\n          {/* <Button type=\"primary\" size=\"small\" onClick={(e) => download()}>导入</Button> */}\n\n          <span style={{ backgroundColor: \"#ffffff\", padding: 4 }} >\n            需平衡时间：{-storeModel.totalAdjustConsumeTime / (3600 * 1000)}h\n        </span>\n\n        </ButtonGroup>\n\n        <Row style={{ margin: \"10px\" }}>\n          <Col flex=\"1 1 auto\">\n            <Input placeholder=\"输入任务，回车添加\" value={title} onChange={(event) => setTitle(event.target.value)} onPressEnter={onAddTask} />\n          </Col>\n          <Col flex=\"0 1 auto\">\n\n            <Dropdown overlay={getMenu()}>\n              <a style={{ paddingLeft: 5 }} className=\"ant-dropdown-link\" onClick={e => e.preventDefault()}>\n                {formartLevel(level)} <DownOutlined />\n              </a>\n            </Dropdown>\n\n            {isNeedExceptTime &&\n              <Input style={{ width: '100px', marginLeft: \"15px\" }} value={expectTime} placeholder=\"花费时间\" prefix=\"预计\" suffix=\"h\" onChange={(event) => setExpectTime(Number(event.target.value))} />\n            }\n\n            <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"估时\" unCheckedChildren=\"不限\" checked={isNeedExceptTime} onChange={(event) => setNeedExceptTime(event)} />\n\n            <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"立刻开始\" unCheckedChildren=\"之后开始\" checked={isStartNow} onChange={(event) => setStartNow(event)} />\n\n            <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"长任务\" unCheckedChildren=\"短任务\" checked={isLongTask} onChange={(event) => setLongTask(event)} />\n\n            <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"周期\" unCheckedChildren=\"单个\" checked={isCycleTask} onChange={(event) => setCycleTask(event)} />\n\n          </Col>\n        </Row>\n\n        <Div style={{ margin: \"10px\", color: \"#ffffff\" }}>\n\n          {!isStartNow &&\n            <span style={{ marginLeft: \"15px\" }} >开始时间：\n        <DatePicker showTime value={expectStartTime} onOk={value => setExpectStartTime(moment(value.valueOf()))} /></span>\n          }\n\n          {isLongTask &&\n            <span style={{ marginLeft: \"15px\" }} >长任务：\n        <Input style={{ width: '100px' }} value={exceptWorkday} prefix=\"计划\" suffix=\"天\" onChange={(event) => setExceptWorkday(Number(event.target.value))} />\n              <Input style={{ width: '100px' }} value={exceptHoliDay} prefix=\"假期\" suffix=\"天\" onChange={(event) => setExceptHoliDay(Number(event.target.value))} />\n            </span>\n          }\n\n          {isCycleTask &&\n            <Input style={{ width: '100px', marginLeft: \"15px\" }} value={cycleGap} placeholder=\"1表示不间隔\" prefix=\"每\" suffix=\"天\" onChange={(event) => setCycleGap(Number(event.target.value))} />\n          }\n\n        </Div>\n\n        <span style={{ backgroundColor: \"#ffffff\", padding: 2, margin: \"10px\" }} >\n          {getAllTaskStatus()}\n        </span>\n\n      </Div>\n\n      <NoteList />\n    </Container>\n  );\n}\n\n\nconst NoteItem = styled.div`\n:hover{\n\t/* background-color:#b4e7fc; */\n  background-color: ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.choosed) {\n      return '#f5b52b'\n    } else {\n      return '#b4e7fc'\n    }\n  }\n  }\n};\nbackground-color: ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.choosed) {\n      return '#f5b52b'\n    } else {\n      return '#ffffff'\n    }\n  }\n  };\nopacity : ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.isDone) {\n      return 0.15\n    } else {\n      return 1\n    }\n  }\n  };;\n`\nconst NoteList: React.FC = () => {\n  const { storeModel } = stores.useStore('mainmodel') as { storeModel: StoreModel };\n  const { currentTask, setCurrentTask } = stores.useStore(CurrentTaskKey) as { currentTask: Task | undefined, setCurrentTask: (note: Task) => void }\n  const { currentDoingTask, setCurrentDoingTask } = stores.useStore(CurrentDoingTaskKey) as { currentDoingTask: Task | undefined, setCurrentDoingTask: (note: Task | undefined) => void }\n  const { save } = stores.useStore('mainmodel') as { save: () => void };\n  const { currentDayOffset, setCurrentDayOffset } = stores.useStore(CurrentDayOffsetKey) as { currentDayOffset: number, setCurrentDayOffset: (offset: number) => void }\n\n  useEffect(() => {\n    // console.log(\"NoteList useEffect\")\n\n    if (currentDoingTask === undefined) {\n      let doingTasks = storeModel.tasks.filter((value) => { return value.isDoing() })\n\n      if (doingTasks.length === 0) {\n        return\n      }\n\n      if (doingTasks.length > 1) {\n        console.error(`有 ${doingTasks.length} 个任务在运行中，自动关闭`)\n\n        for (let i = 1; i < doingTasks.length; i++) {\n          doingTasks[i].stop()\n        }\n      }\n\n      setCurrentDoingTask(doingTasks[0])\n    }\n  });\n\n  function onChooseNote(event: any, note: Task) {\n    event.preventDefault()\n    setCurrentTask(note)\n  }\n\n  const onClickMenu = (param: ClickParam, task: Task) => {\n    task.level = Number(param.key)\n\n    storeModel.normalUpdate()\n    save()\n\n    param.domEvent.preventDefault()\n\n    // 怎么阻止对 parent 的点击事件\n    // param.domEvent.stopPropagation()\n  };\n\n  function getMenu(task: Task): React.ReactElement {\n    return (\n      <Menu onClick={(param) => onClickMenu(param, task)}>\n        <Menu.Item key=\"1\">优先级 1</Menu.Item>\n        <Menu.Item key=\"2\">优先级 2</Menu.Item>\n        <Menu.Item key=\"3\">优先级 3</Menu.Item>\n        <Menu.Item key=\"4\">优先级 4</Menu.Item>\n        <Menu.Item key=\"5\">优先级 5</Menu.Item>\n      </Menu>\n    )\n  }\n\n  function startTask(event: any, task: Task) {\n    if (task.isDone()) {\n      message.error(`任务已完成，完成时间:${Format.formatTimeInMs(task.doneTime)}`)\n      return\n    }\n\n    if (currentDoingTask != undefined && currentDoingTask.id === task.id) {\n      message.error(`任务已经在进行中，上次开始时间：${Format.formatTimeInMs(task.lastStartTime())}`)\n      return\n    }\n\n    if (task.isDoing()) {\n      // todo 自动恢复\n      message.error(`任务异常中断，重新开始。上次开始时间：${Format.formatTimeInMs(task.lastStartTime())}`)\n    }\n\n    if (currentDoingTask != undefined) {\n      currentDoingTask.stop()\n    }\n\n    task.start()\n    setCurrentDoingTask(task)\n    storeModel.normalUpdate()\n    save()\n  }\n\n  function getShowTips(task: Task): string {\n    let result = \"  \" + TaskInfoFormat.getDoingStatusTips(task) + TaskInfoFormat.getDeadline(task) + TaskInfoFormat.getConsumeExpected(task)\n    return result\n  }\n\n  return (\n    <Container2>\n      <List\n        size=\"small\"\n        style={{ backgroundColor: 'white', margin: \"1%\" }}\n        bordered\n        dataSource={storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset))}\n        renderItem={task => (\n          <NoteItem choosed={task.isSameTask(currentTask)} key={task.id} onClick={(e) => onChooseNote(e, task)} isDone={task.isDone()} onDoubleClick={(e) => startTask(e, task)}>\n\n            <Row>\n              <Col flex=\"1 1 auto\">\n                <NoteItemInput key={task.id} task={task} />\n              </Col>\n              <Col flex=\"0 1 auto\">\n\n                {getShowTips(task)}\n                <Dropdown overlay={getMenu(task)}>\n                  <a style={{ paddingLeft: 5 }} className=\"ant-dropdown-link\" onClick={e => e.preventDefault()}>\n                    {formartLevel(task.level)} <DownOutlined />\n                  </a>\n                </Dropdown>\n\n                <Button onClick={(e) => startTask(e, task)}>Start</Button>\n\n              </Col>\n            </Row>\n\n          </NoteItem>\n        )}\n      />\n    </Container2>\n  );\n}\n\nfunction formartLevel(level: number): string {\n  switch (level) {\n    case 1:\n      return \"🌟\"\n    case 2:\n      return \"🎏\"\n    case 3:\n      return \"3️⃣\"\n    case 4:\n      return \"4️\"\n    case 5:\n      return \"5️\"\n    default:\n      return \"\"\n  }\n\n  // switch (level) {\n  //   case 1:\n  //     return \"🥇\"\n  //   case 2:\n  //     return \"🥈\"\n  //   case 3:\n  //     return \"🥉\"\n  //   case 4:\n  //     return \"4️⃣\"\n  //   case 5:\n  //     return \"5️\"\n  //   default:\n  //     return \"\"\n  // }\n}\n\ninterface NoteItemInputProps {\n  task: Task;\n}\n\nconst NoteItemInput: React.FC<NoteItemInputProps> = (props) => {\n  const [content, setContent] = useState(props.task.title)\n  const { save } = stores.useStore('mainmodel') as { save: () => void };\n\n  function saveTaskTitle(event: any) {\n    props.task.title = content\n    save()\n  }\n\n  return (\n    <Input style={{ background: \"#ffffff70\", fontWeight: \"bold\" }} value={content} onChange={(e) => setContent(e.target.value)} onBlur={saveTaskTitle} />\n  );\n}\n\nexport default TaskListContainer;"]},"metadata":{},"sourceType":"module"}