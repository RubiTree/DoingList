{"ast":null,"code":"var _jsxFileName = \"/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/src/layouts/TaskListContainer.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Input, message, Switch, Button, Row, Col, List, Dropdown, Menu, Modal, DatePicker } from 'antd'; // è¿™æ ·å±…ç„¶çœŸçš„è¡Œ\n\n// import { DateType } from 'antd/lib/date-picker';\nimport { DownOutlined } from '@ant-design/icons';\nimport stores from '../stores';\nimport { StoreModel } from '../model/model';\nimport Utils from '../utils/Utils';\nimport DateUtils from '../utils/DateUtils';\nimport TaskInfoFormat from '../utils/TaskInfoFormat';\nimport Format from '../utils/Format';\nimport { Task, CycleRecord } from '../model/model';\nimport { CurrentTaskKey } from '../stores/CurrentTaskStore';\nimport { CurrentDoingTaskKey } from '../stores/CurrentDoingTaskStore';\nimport { CurrentDayOffsetKey } from '../stores/CurrentDayOffsetStore';\nimport 'antd/dist/antd.css';\nimport { plainToClass } from \"class-transformer\";\nimport moment from 'moment';\nconst Container = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n`;\nconst Div = styled.div`\n`;\nconst ParamTag = styled.span`\n  width:100px;\n  display:inline-block;\n  text-align:center;\n`;\nconst Container2 = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n  overflow:auto;\n  /* height: 800px; */\n  height: 85vh;\n  margin-top:10px;\n`;\nconst InputGroup = styled(Input.Group)`\nmargin: 1%;\n`;\nconst ButtonGroup = styled(Button.Group)`\nmargin: 1%;\n`;\n\nconst TaskListContainer = () => {\n  const {\n    storeModel,\n    save,\n    setModel\n  } = stores.useStore('mainmodel');\n  const {\n    currentDayOffset,\n    setCurrentDayOffset\n  } = stores.useStore(CurrentDayOffsetKey);\n  const [title, setTitle] = useState(\"\");\n  const [isNeedExceptTime, setNeedExceptTimeUI] = useState(true);\n  const [expectTime, setExpectTime] = useState(2);\n  const [level, setLevel] = useState(3);\n  const [isCycleTask, setCycleTaskUI] = useState(true);\n  const [cycleGap, setCycleGap] = useState(1);\n  const [isLongTask, setLongTaskUI] = useState(true);\n  const [exceptWorkday, setExceptWorkday] = useState(3);\n  const [exceptHoliDay, setExceptHoliDay] = useState(1);\n  const [isStartNow, setStartNow] = useState(false);\n  const [expectStartTime, setExpectStartTime] = useState(null); // React.useEffect(() => {\n  //   console.log(\"TaskListContainer useEffect\")\n  // },[])\n\n  function setNeedExceptTime(isNeedExceptTime) {\n    if (!isNeedExceptTime && isCycleTask) {\n      message.error(\"å‘¨æœŸä»»åŠ¡å¿…é¡»ä¼°æ—¶\");\n      return;\n    }\n\n    setNeedExceptTimeUI(isNeedExceptTime);\n  }\n\n  function setCycleTask(isCycleTask) {\n    if (isCycleTask) {\n      setNeedExceptTime(true);\n      setLongTask(false);\n    }\n\n    setCycleTaskUI(isCycleTask);\n  }\n\n  function setLongTask(isLongTask) {\n    if (isLongTask) {\n      setCycleTask(false);\n    }\n\n    setLongTaskUI(isLongTask);\n  }\n\n  function onAddTask(event) {\n    event.preventDefault();\n\n    if (Utils.isStringEmpty(title)) {\n      message.error(\"è¯·è¾“å…¥å†…å®¹\");\n      return;\n    }\n\n    if (isLongTask && isCycleTask) {\n      message.error(\"ä¸èƒ½åŒæ—¶æ˜¯é•¿ä»»åŠ¡å’Œå‘¨æœŸä»»åŠ¡\");\n      return;\n    }\n\n    if (isCycleTask) {\n      const newRecord = new CycleRecord();\n      newRecord.init(cycleGap, title, level);\n\n      if (!isStartNow && expectStartTime !== null) {\n        newRecord.setStartTime(expectStartTime);\n      }\n\n      if (isNeedExceptTime) {\n        newRecord.expectConsumes = expectTime * 3600 * 1000; // å•ä½å°æ—¶ï¼Œè½¬æ¢\n      } else {\n        newTask.expectConsumes.push(-1); // è¡¨ç¤ºä¸è®¾ç½®æ—¶é—´\n      }\n    } else {\n      const newTask = new Task();\n      newTask.init(title);\n      newTask.level = level;\n\n      if (!isStartNow && expectStartTime !== null) {\n        newTask.expectStartTime = expectStartTime;\n      }\n\n      if (isNeedExceptTime) {\n        newTask.expectConsumes.push(expectTime * 3600 * 1000); // å•ä½å°æ—¶ï¼Œè½¬æ¢\n      } else {\n        newTask.expectConsumes.push(-1); // è¡¨ç¤ºä¸è®¾ç½®æ—¶é—´\n      }\n\n      storeModel.addTask(newTask);\n      storeModel.orderTasks();\n    }\n\n    save();\n    setTitle(\"\");\n    setExpectStartTime(null);\n  }\n\n  function changeOffsetDay(isAdd) {\n    if (isAdd) {\n      setCurrentDayOffset(currentDayOffset + 1);\n    } else {\n      setCurrentDayOffset(currentDayOffset - 1);\n    }\n  }\n\n  function download() {\n    Utils.downloadFile(`DoingList_${Format.formatTimeInMsToFileName(Utils.getTimestamp())}.dl`, JSON.stringify(storeModel));\n  }\n\n  function upload(e) {\n    let file = e.target.files[0];\n    console.log(file);\n    let reader = new FileReader();\n\n    reader.onload = function () {\n      let uploadContent = this.result;\n\n      if (typeof uploadContent === 'string') {\n        Modal.confirm({\n          title: 'ç¡®å®šè¦å¯¼å…¥å˜›ï¼Ÿ',\n          content: `å¯¼å…¥ä¼šè¦†ç›–å½“å‰æ‰€æœ‰ä»»åŠ¡`,\n\n          onOk() {\n            Modal.confirm({\n              title: 'æ˜¯å¦éœ€è¦å…ˆä¸‹è½½å½“å‰ä»»åŠ¡ï¼Ÿ',\n              content: ``,\n\n              onOk() {\n                download();\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent)));\n              },\n\n              onCancel() {\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent)));\n              }\n\n            });\n          }\n\n        });\n      } else {\n        message.error(\"å¯¼å…¥æ–‡ä»¶æœ‰é—®é¢˜ï¼Œå¯¼å…¥å¤±è´¥\");\n      }\n    }; //è¯»å–æ–‡ä»¶å†…å®¹\n\n\n    reader.readAsText(file);\n  }\n\n  function getOffsetString() {\n    let base = \"\" + currentDayOffset;\n\n    if (currentDayOffset > 0) {\n      base = \"+\" + base;\n    }\n\n    return base;\n  }\n\n  function getAllTaskStatus() {\n    let notDoneTasks = storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)).filter(task => {\n      return !task.isDone();\n    });\n\n    if (notDoneTasks.length === 0) {\n      return \"\";\n    }\n\n    let consumeFormat = \"\";\n    let consumes = notDoneTasks.map(task => {\n      let left = task.getLeftExpectConsumeTime();\n      if (left < 0) return 0;\n      return left;\n    }).reduce((a, b) => a + b); // console.log(\"getAllTaskStatus\" + consumes)\n\n    if (consumes > 0) {\n      consumeFormat = `ï¼Œæ€»å‰©ä½™é¢„ä¼°éœ€è¦èŠ±è´¹${Format.formatDuration(consumes)}`;\n    }\n\n    return `å…±${notDoneTasks.length}ä¸ªä»»åŠ¡æœªå®Œæˆ${consumeFormat}`;\n  }\n\n  function getMenu() {\n    return /*#__PURE__*/React.createElement(Menu, {\n      onClick: param => setLevel(Number(param.key)),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 1\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 2\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 3\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 4\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 5\"));\n  }\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ButtonGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    size: \"small\",\n    onClick: e => changeOffsetDay(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 9\n    }\n  }, \"\\u2190\"), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      backgroundColor: \"#ffffff\",\n      padding: 4\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }\n  }, Format.formatTimeInDay(DateUtils.getMyCurrentDayStamp(currentDayOffset)), \"(\", getOffsetString(), \")\"), /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    size: \"small\",\n    onClick: e => changeOffsetDay(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }\n  }, \"\\u2192\"), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      paddingLeft: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    size: \"small\",\n    onClick: e => download(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 9\n    }\n  }, \"\\u5BFC\\u51FA\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    id: \"upload-file\",\n    multiple: true,\n    onChange: event => upload(event),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"1 1 auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    placeholder: \"\\u8F93\\u5165\\u4EFB\\u52A1\\uFF0C\\u56DE\\u8F66\\u6DFB\\u52A0\",\n    value: title,\n    onChange: event => setTitle(event.target.value),\n    onPressEnter: onAddTask,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    flex: \"0 1 auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Dropdown, {\n    overlay: getMenu(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    style: {\n      paddingLeft: 5\n    },\n    className: \"ant-dropdown-link\",\n    onClick: e => e.preventDefault(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 13\n    }\n  }, formartLevel(level), \" \", /*#__PURE__*/React.createElement(DownOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(Switch, {\n    style: {\n      marginLeft: '5px',\n      marginRight: '3px'\n    },\n    checkedChildren: \"\\u4F30\\u65F6\",\n    unCheckedChildren: \"\\u4E0D\\u9650\",\n    checked: isNeedExceptTime,\n    onChange: event => setNeedExceptTime(event),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    style: {\n      marginLeft: '5px',\n      marginRight: '3px'\n    },\n    checkedChildren: \"\\u7ACB\\u523B\\u5F00\\u59CB\",\n    unCheckedChildren: \"\\u4E4B\\u540E\\u5F00\\u59CB\",\n    checked: isStartNow,\n    onChange: event => setStartNow(event),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    style: {\n      marginLeft: '5px',\n      marginRight: '3px'\n    },\n    checkedChildren: \"\\u957F\\u4EFB\\u52A1\",\n    unCheckedChildren: \"\\u77ED\\u4EFB\\u52A1\",\n    checked: isLongTask,\n    onChange: event => setLongTask(event),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    style: {\n      marginLeft: '5px',\n      marginRight: '3px'\n    },\n    checkedChildren: \"\\u5468\\u671F\",\n    unCheckedChildren: \"\\u5355\\u4E2A\",\n    checked: isCycleTask,\n    onChange: event => setCycleTask(event),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Div, {\n    style: {\n      margin: \"10px\",\n      color: \"#ffffff\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }\n  }, isNeedExceptTime && /*#__PURE__*/React.createElement(Input, {\n    style: {\n      width: '100px',\n      marginLeft: \"15px\"\n    },\n    value: expectTime,\n    placeholder: \"\\u82B1\\u8D39\\u65F6\\u95F4\",\n    prefix: \"\\u9884\\u8BA1\",\n    suffix: \"h\",\n    onChange: event => setExpectTime(Number(event.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 11\n    }\n  }), !isStartNow && /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      marginLeft: \"15px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 11\n    }\n  }, \"\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\", /*#__PURE__*/React.createElement(DatePicker, {\n    showTime: true,\n    value: expectStartTime,\n    onOk: value => setExpectStartTime(moment(value.valueOf())),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 9\n    }\n  })), isLongTask && /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      marginLeft: \"15px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 11\n    }\n  }, \"\\u957F\\u4EFB\\u52A1\\uFF1A\", /*#__PURE__*/React.createElement(Input, {\n    style: {\n      width: '100px'\n    },\n    value: exceptWorkday,\n    prefix: \"\\u8BA1\\u5212\",\n    suffix: \"\\u5929\",\n    onChange: event => setExceptWorkday(Number(event.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Input, {\n    style: {\n      width: '100px'\n    },\n    value: exceptHoliDay,\n    prefix: \"\\u5047\\u671F\",\n    suffix: \"\\u5929\",\n    onChange: event => setExceptHoliDay(Number(event.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 13\n    }\n  })), isCycleTask && /*#__PURE__*/React.createElement(Input, {\n    style: {\n      width: '100px',\n      marginLeft: \"15px\"\n    },\n    value: cycleGap,\n    placeholder: \"1\\u8868\\u793A\\u4E0D\\u95F4\\u9694\",\n    prefix: \"\\u6BCF\",\n    suffix: \"\\u5929\",\n    onChange: event => setCycleGap(Number(event.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      backgroundColor: \"#ffffff\",\n      padding: 2,\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }\n  }, getAllTaskStatus()), /*#__PURE__*/React.createElement(NoteList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }\n  }));\n};\n\nconst NoteItem = styled.div`\n:hover{\n\t/* background-color:#b4e7fc; */\n  background-color: ${props => {\n  if (props.choosed) {\n    return '#f5b52b';\n  } else {\n    return '#b4e7fc';\n  }\n}}\n};\nbackground-color: ${props => {\n  if (props.choosed) {\n    return '#f5b52b';\n  } else {\n    return '#ffffff';\n  }\n}};\nopacity : ${props => {\n  if (props.isDone) {\n    return 0.15;\n  } else {\n    return 1;\n  }\n}};;\n`;\n\nconst NoteList = () => {\n  const {\n    storeModel\n  } = stores.useStore('mainmodel');\n  const {\n    currentTask,\n    setCurrentTask\n  } = stores.useStore(CurrentTaskKey);\n  const {\n    currentDoingTask,\n    setCurrentDoingTask\n  } = stores.useStore(CurrentDoingTaskKey);\n  const {\n    save\n  } = stores.useStore('mainmodel');\n  const {\n    currentDayOffset,\n    setCurrentDayOffset\n  } = stores.useStore(CurrentDayOffsetKey);\n  useEffect(() => {\n    // console.log(\"NoteList useEffect\")\n    if (currentDoingTask === undefined) {\n      let doingTasks = storeModel.tasks.filter(value => {\n        return value.isDoing();\n      });\n\n      if (doingTasks.length === 0) {\n        return;\n      }\n\n      if (doingTasks.length > 1) {\n        console.error(`æœ‰ ${doingTasks.length} ä¸ªä»»åŠ¡åœ¨è¿è¡Œä¸­ï¼Œè‡ªåŠ¨å…³é—­`);\n\n        for (let i = 1; i < doingTasks.length; i++) {\n          doingTasks[i].stop();\n        }\n      }\n\n      setCurrentDoingTask(doingTasks[0]);\n    }\n  });\n\n  function onChooseNote(event, note) {\n    event.preventDefault();\n    setCurrentTask(note);\n  }\n\n  const onClickMenu = (param, task) => {\n    task.level = Number(param.key);\n    storeModel.orderTasks();\n    save();\n    param.domEvent.preventDefault(); // æ€ä¹ˆé˜»æ­¢å¯¹ parent çš„ç‚¹å‡»äº‹ä»¶\n    // param.domEvent.stopPropagation()\n  };\n\n  function getMenu(task) {\n    return /*#__PURE__*/React.createElement(Menu, {\n      onClick: param => onClickMenu(param, task),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 1\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 2\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 3\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 4\"), /*#__PURE__*/React.createElement(Menu.Item, {\n      key: \"5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }\n    }, \"\\u4F18\\u5148\\u7EA7 5\"));\n  }\n\n  function startTask(event, task) {\n    if (task.isDone()) {\n      message.error(`ä»»åŠ¡å·²å®Œæˆï¼Œå®Œæˆæ—¶é—´:${Format.formatTimeInMs(task.doneTime)}`);\n      return;\n    }\n\n    if (currentDoingTask != undefined && currentDoingTask.id === task.id) {\n      message.error(`ä»»åŠ¡å·²ç»åœ¨è¿›è¡Œä¸­ï¼Œä¸Šæ¬¡å¼€å§‹æ—¶é—´ï¼š${Format.formatTimeInMs(task.lastStartTime())}`);\n      return;\n    }\n\n    if (task.isDoing()) {\n      // todo è‡ªåŠ¨æ¢å¤\n      message.error(`ä»»åŠ¡å¼‚å¸¸ä¸­æ–­ï¼Œé‡æ–°å¼€å§‹ã€‚ä¸Šæ¬¡å¼€å§‹æ—¶é—´ï¼š${Format.formatTimeInMs(task.lastStartTime())}`);\n    }\n\n    if (currentDoingTask != undefined) {\n      currentDoingTask.stop();\n    }\n\n    task.start();\n    setCurrentDoingTask(task);\n    storeModel.orderTasks();\n    save();\n  }\n\n  function getShowTips(task) {\n    let result = \"  \" + TaskInfoFormat.getDoingStatusTips(task) + TaskInfoFormat.getDeadline(task) + TaskInfoFormat.getConsumeExpected(task);\n    return result;\n  }\n\n  return /*#__PURE__*/React.createElement(Container2, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    size: \"small\",\n    style: {\n      backgroundColor: 'white',\n      margin: \"1%\"\n    },\n    bordered: true,\n    dataSource: storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)),\n    renderItem: task => /*#__PURE__*/React.createElement(NoteItem, {\n      choosed: task.isSameTask(currentTask),\n      key: task.id,\n      onClick: e => onChooseNote(e, task),\n      isDone: task.isDone(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      flex: \"1 1 auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(NoteItemInput, {\n      key: task.id,\n      task: task,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      flex: \"0 1 auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 15\n      }\n    }, getShowTips(task), /*#__PURE__*/React.createElement(Dropdown, {\n      overlay: getMenu(task),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      style: {\n        paddingLeft: 5\n      },\n      className: \"ant-dropdown-link\",\n      onClick: e => e.preventDefault(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 19\n      }\n    }, formartLevel(task.level), \" \", /*#__PURE__*/React.createElement(DownOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 48\n      }\n    }))), /*#__PURE__*/React.createElement(Button, {\n      onClick: e => startTask(e, task),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 17\n      }\n    }, \"Start\")))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 7\n    }\n  }));\n};\n\nfunction formartLevel(level) {\n  switch (level) {\n    case 1:\n      return \"ğŸŒŸ\";\n\n    case 2:\n      return \"ğŸ\";\n\n    case 3:\n      return \"3ï¸âƒ£\";\n\n    case 4:\n      return \"4ï¸\";\n\n    case 5:\n      return \"5ï¸\";\n\n    default:\n      return \"\";\n  } // switch (level) {\n  //   case 1:\n  //     return \"ğŸ¥‡\"\n  //   case 2:\n  //     return \"ğŸ¥ˆ\"\n  //   case 3:\n  //     return \"ğŸ¥‰\"\n  //   case 4:\n  //     return \"4ï¸âƒ£\"\n  //   case 5:\n  //     return \"5ï¸\"\n  //   default:\n  //     return \"\"\n  // }\n\n}\n\nconst NoteItemInput = props => {\n  const [content, setContent] = useState(props.task.title);\n  const {\n    save\n  } = stores.useStore('mainmodel');\n\n  function saveTaskTitle(event) {\n    props.task.title = content;\n    save();\n  }\n\n  return /*#__PURE__*/React.createElement(Input, {\n    style: {\n      background: \"#ffffff70\",\n      fontWeight: \"bold\"\n    },\n    value: content,\n    onChange: e => setContent(e.target.value),\n    onBlur: saveTaskTitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 518,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default TaskListContainer;","map":{"version":3,"sources":["/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/src/layouts/TaskListContainer.tsx"],"names":["React","useState","useEffect","styled","Input","message","Switch","Button","Row","Col","List","Dropdown","Menu","Modal","DatePicker","DownOutlined","stores","StoreModel","Utils","DateUtils","TaskInfoFormat","Format","Task","CycleRecord","CurrentTaskKey","CurrentDoingTaskKey","CurrentDayOffsetKey","plainToClass","moment","Container","div","Div","ParamTag","span","Container2","InputGroup","Group","ButtonGroup","TaskListContainer","storeModel","save","setModel","useStore","currentDayOffset","setCurrentDayOffset","title","setTitle","isNeedExceptTime","setNeedExceptTimeUI","expectTime","setExpectTime","level","setLevel","isCycleTask","setCycleTaskUI","cycleGap","setCycleGap","isLongTask","setLongTaskUI","exceptWorkday","setExceptWorkday","exceptHoliDay","setExceptHoliDay","isStartNow","setStartNow","expectStartTime","setExpectStartTime","setNeedExceptTime","error","setCycleTask","setLongTask","onAddTask","event","preventDefault","isStringEmpty","newRecord","init","setStartTime","expectConsumes","newTask","push","addTask","orderTasks","changeOffsetDay","isAdd","download","downloadFile","formatTimeInMsToFileName","getTimestamp","JSON","stringify","upload","e","file","target","files","console","log","reader","FileReader","onload","uploadContent","result","confirm","content","onOk","parse","onCancel","readAsText","getOffsetString","base","getAllTaskStatus","notDoneTasks","getTasks","getMyCurrentDayDur","filter","task","isDone","length","consumeFormat","consumes","map","left","getLeftExpectConsumeTime","reduce","a","b","formatDuration","getMenu","param","Number","key","backgroundColor","padding","formatTimeInDay","getMyCurrentDayStamp","paddingLeft","margin","value","formartLevel","marginLeft","marginRight","color","width","valueOf","NoteItem","props","choosed","NoteList","currentTask","setCurrentTask","currentDoingTask","setCurrentDoingTask","undefined","doingTasks","tasks","isDoing","i","stop","onChooseNote","note","onClickMenu","domEvent","startTask","formatTimeInMs","doneTime","id","lastStartTime","start","getShowTips","getDoingStatusTips","getDeadline","getConsumeExpected","isSameTask","NoteItemInput","setContent","saveTaskTitle","background","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Input, message, Switch, Button, Row, Col, List, Dropdown, Menu, Modal, DatePicker } from 'antd';\n// è¿™æ ·å±…ç„¶çœŸçš„è¡Œ\nimport { ClickParam } from 'antd/lib/menu';\n// import { DateType } from 'antd/lib/date-picker';\nimport { DownOutlined } from '@ant-design/icons';\nimport stores from '../stores';\nimport { StoreModel, Duration } from '../model/model'\nimport Utils from '../utils/Utils'\nimport DateUtils from '../utils/DateUtils'\nimport TaskInfoFormat from '../utils/TaskInfoFormat'\nimport Format from '../utils/Format'\nimport { Task, Note, CycleRecord } from '../model/model'\nimport { CurrentTaskKey } from '../stores/CurrentTaskStore';\nimport { CurrentDoingTaskKey } from '../stores/CurrentDoingTaskStore';\nimport { CurrentDayOffsetKey } from '../stores/CurrentDayOffsetStore';\nimport 'antd/dist/antd.css';\nimport { plainToClass } from \"class-transformer\";\nimport moment from 'moment'\n\nconst Container = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n`\n\nconst Div = styled.div`\n`\n\nconst ParamTag = styled.span`\n  width:100px;\n  display:inline-block;\n  text-align:center;\n`\n\nconst Container2 = styled.div`\n  /* background: #d1d3a2; */\n  /* background: #d1dfff; */\n  background: #282c34;\n  overflow:auto;\n  /* height: 800px; */\n  height: 85vh;\n  margin-top:10px;\n`\n\nconst InputGroup = styled(Input.Group)`\nmargin: 1%;\n`\nconst ButtonGroup = styled(Button.Group)`\nmargin: 1%;\n`\n\nconst TaskListContainer: React.FC = () => {\n  const { storeModel, save, setModel } = stores.useStore('mainmodel') as { storeModel: StoreModel, save: () => void, setModel: (storeModel: StoreModel) => void };\n  const { currentDayOffset, setCurrentDayOffset } = stores.useStore(CurrentDayOffsetKey) as { currentDayOffset: number, setCurrentDayOffset: (offset: number) => void }\n  const [title, setTitle] = useState(\"\");\n  const [isNeedExceptTime, setNeedExceptTimeUI] = useState(true);\n  const [expectTime, setExpectTime] = useState(2);\n\n  const [level, setLevel] = useState(3);\n\n  const [isCycleTask, setCycleTaskUI] = useState(true);\n  const [cycleGap, setCycleGap] = useState(1);\n\n  const [isLongTask, setLongTaskUI] = useState(true);\n  const [exceptWorkday, setExceptWorkday] = useState(3);\n  const [exceptHoliDay, setExceptHoliDay] = useState(1);\n\n  const [isStartNow, setStartNow] = useState(false);\n  const [expectStartTime, setExpectStartTime] = useState<any>(null);\n\n  // React.useEffect(() => {\n  //   console.log(\"TaskListContainer useEffect\")\n  // },[])\n\n  function setNeedExceptTime(isNeedExceptTime: boolean) {\n    if (!isNeedExceptTime && isCycleTask) {\n      message.error(\"å‘¨æœŸä»»åŠ¡å¿…é¡»ä¼°æ—¶\")\n      return\n    }\n\n    setNeedExceptTimeUI(isNeedExceptTime)\n  }\n\n  function setCycleTask(isCycleTask: boolean) {\n    if (isCycleTask) {\n      setNeedExceptTime(true)\n      setLongTask(false)\n    }\n\n    setCycleTaskUI(isCycleTask)\n  }\n\n  function setLongTask(isLongTask: boolean) {\n    if (isLongTask) {\n      setCycleTask(false)\n    }\n\n    setLongTaskUI(isLongTask)\n  }\n\n  function onAddTask(event: any) {\n    event.preventDefault();\n\n    if (Utils.isStringEmpty(title)) {\n      message.error(\"è¯·è¾“å…¥å†…å®¹\")\n      return\n    }\n    if (isLongTask && isCycleTask) {\n      message.error(\"ä¸èƒ½åŒæ—¶æ˜¯é•¿ä»»åŠ¡å’Œå‘¨æœŸä»»åŠ¡\")\n      return\n    }\n\n    if (isCycleTask) {\n      const newRecord = new CycleRecord()\n      newRecord.init(cycleGap, title, level)\n\n      if (!isStartNow && expectStartTime !== null) {\n        newRecord.setStartTime(expectStartTime)\n      }\n\n      if (isNeedExceptTime) {\n        newRecord.expectConsumes = (expectTime * 3600 * 1000) // å•ä½å°æ—¶ï¼Œè½¬æ¢\n      } else {\n        newTask.expectConsumes.push(-1) // è¡¨ç¤ºä¸è®¾ç½®æ—¶é—´\n      }\n\n    } else {\n      const newTask = new Task()\n      newTask.init(title)\n      newTask.level = level\n\n      if (!isStartNow && expectStartTime !== null) {\n        newTask.expectStartTime = expectStartTime\n      }\n\n      if (isNeedExceptTime) {\n        newTask.expectConsumes.push(expectTime * 3600 * 1000) // å•ä½å°æ—¶ï¼Œè½¬æ¢\n      } else {\n        newTask.expectConsumes.push(-1) // è¡¨ç¤ºä¸è®¾ç½®æ—¶é—´\n      }\n\n      storeModel.addTask(newTask)\n      storeModel.orderTasks()\n    }\n\n\n    save()\n\n    setTitle(\"\")\n    setExpectStartTime(null)\n  }\n\n  function changeOffsetDay(isAdd: boolean) {\n    if (isAdd) {\n      setCurrentDayOffset(currentDayOffset + 1)\n    } else {\n      setCurrentDayOffset(currentDayOffset - 1)\n    }\n  }\n\n  function download() {\n    Utils.downloadFile(`DoingList_${Format.formatTimeInMsToFileName(Utils.getTimestamp())}.dl`, JSON.stringify(storeModel))\n  }\n\n  function upload(e: any) {\n    let file = e.target.files[0];\n    console.log(file)\n\n    let reader = new FileReader();\n    reader.onload = function (this) {\n      let uploadContent = this.result\n      if (typeof uploadContent === 'string') {\n        Modal.confirm({\n          title: 'ç¡®å®šè¦å¯¼å…¥å˜›ï¼Ÿ',\n          content: `å¯¼å…¥ä¼šè¦†ç›–å½“å‰æ‰€æœ‰ä»»åŠ¡`,\n          onOk() {\n            Modal.confirm({\n              title: 'æ˜¯å¦éœ€è¦å…ˆä¸‹è½½å½“å‰ä»»åŠ¡ï¼Ÿ',\n              content: ``,\n              onOk() {\n                download()\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent as string)))\n              },\n              onCancel() {\n                setModel(plainToClass(StoreModel, JSON.parse(uploadContent as string)))\n              }\n            });\n          },\n        })\n      } else {\n        message.error(\"å¯¼å…¥æ–‡ä»¶æœ‰é—®é¢˜ï¼Œå¯¼å…¥å¤±è´¥\")\n      }\n    }\n    //è¯»å–æ–‡ä»¶å†…å®¹\n    reader.readAsText(file);\n  }\n\n  function getOffsetString() {\n    let base = \"\" + currentDayOffset\n    if (currentDayOffset > 0) {\n      base = \"+\" + base\n    }\n    return base\n  }\n\n  function getAllTaskStatus(): string {\n    let notDoneTasks = storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset)).filter((task) => { return !task.isDone() })\n\n    if (notDoneTasks.length === 0) {\n      return \"\"\n    }\n\n    let consumeFormat = \"\"\n    let consumes: number = notDoneTasks.map((task) => {\n      let left = task.getLeftExpectConsumeTime()\n      if (left < 0) return 0\n      return left\n    }).reduce((a, b) => a + b)\n\n    // console.log(\"getAllTaskStatus\" + consumes)\n    if (consumes > 0) {\n      consumeFormat = `ï¼Œæ€»å‰©ä½™é¢„ä¼°éœ€è¦èŠ±è´¹${Format.formatDuration(consumes)}`\n    }\n\n    return `å…±${notDoneTasks.length}ä¸ªä»»åŠ¡æœªå®Œæˆ${consumeFormat}`\n  }\n\n  function getMenu(): React.ReactElement {\n    return (\n      <Menu onClick={(param) => setLevel(Number(param.key))}>\n        <Menu.Item key=\"1\">ä¼˜å…ˆçº§ 1</Menu.Item>\n        <Menu.Item key=\"2\">ä¼˜å…ˆçº§ 2</Menu.Item>\n        <Menu.Item key=\"3\">ä¼˜å…ˆçº§ 3</Menu.Item>\n        <Menu.Item key=\"4\">ä¼˜å…ˆçº§ 4</Menu.Item>\n        <Menu.Item key=\"5\">ä¼˜å…ˆçº§ 5</Menu.Item>\n      </Menu>\n    )\n  }\n\n  return (\n    <Container>\n\n      {/* todo è¿™ä¸ªç»„ä»¶å¯ä»¥å•ç‹¬æŠ½å‡ºå» */}\n      <ButtonGroup>\n        <Button type=\"primary\" size=\"small\" onClick={(e) => changeOffsetDay(false)}>â†</Button>\n\n        <span style={{ backgroundColor: \"#ffffff\", padding: 4 }} >\n          {Format.formatTimeInDay(DateUtils.getMyCurrentDayStamp(currentDayOffset))}({getOffsetString()})\n        </span>\n\n        <Button type=\"primary\" size=\"small\" onClick={(e) => changeOffsetDay(true)}>â†’</Button>\n        <span style={{ paddingLeft: 10 }} ></span>\n        <Button type=\"primary\" size=\"small\" onClick={(e) => download()}>å¯¼å‡º</Button>\n        <input type=\"file\" id=\"upload-file\" multiple onChange={(event) => upload(event)} />\n        {/* <Button type=\"primary\" size=\"small\" onClick={(e) => download()}>å¯¼å…¥</Button> */}\n      </ButtonGroup>\n\n      <Row style={{ margin: \"10px\" }}>\n        <Col flex=\"1 1 auto\">\n          <Input placeholder=\"è¾“å…¥ä»»åŠ¡ï¼Œå›è½¦æ·»åŠ \" value={title} onChange={(event) => setTitle(event.target.value)} onPressEnter={onAddTask} />\n        </Col>\n        <Col flex=\"0 1 auto\">\n\n          <Dropdown overlay={getMenu()}>\n            <a style={{ paddingLeft: 5 }} className=\"ant-dropdown-link\" onClick={e => e.preventDefault()}>\n              {formartLevel(level)} <DownOutlined />\n            </a>\n          </Dropdown>\n\n          <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"ä¼°æ—¶\" unCheckedChildren=\"ä¸é™\" checked={isNeedExceptTime} onChange={(event) => setNeedExceptTime(event)} />\n\n          <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"ç«‹åˆ»å¼€å§‹\" unCheckedChildren=\"ä¹‹åå¼€å§‹\" checked={isStartNow} onChange={(event) => setStartNow(event)} />\n\n          {/* todo é•¿ä»»åŠ¡ä¼šé»˜è®¤æ‰“å¼€ä¼°æ—¶ */}\n          <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"é•¿ä»»åŠ¡\" unCheckedChildren=\"çŸ­ä»»åŠ¡\" checked={isLongTask} onChange={(event) => setLongTask(event)} />\n\n          <Switch style={{ marginLeft: '5px', marginRight: '3px' }} checkedChildren=\"å‘¨æœŸ\" unCheckedChildren=\"å•ä¸ª\" checked={isCycleTask} onChange={(event) => setCycleTask(event)} />\n\n        </Col>\n      </Row>\n\n      <Div style={{ margin: \"10px\", color: \"#ffffff\" }}>\n        {isNeedExceptTime &&\n          <Input style={{ width: '100px', marginLeft: \"15px\" }} value={expectTime} placeholder=\"èŠ±è´¹æ—¶é—´\" prefix=\"é¢„è®¡\" suffix=\"h\" onChange={(event) => setExpectTime(Number(event.target.value))} />\n        }\n\n        {!isStartNow &&\n          <span style={{ marginLeft: \"15px\" }} >å¼€å§‹æ—¶é—´ï¼š\n        <DatePicker showTime value={expectStartTime} onOk={value => setExpectStartTime(moment(value.valueOf()))} /></span>\n        }\n\n        {isLongTask &&\n          <span style={{ marginLeft: \"15px\" }} >é•¿ä»»åŠ¡ï¼š\n        <Input style={{ width: '100px' }} value={exceptWorkday} prefix=\"è®¡åˆ’\" suffix=\"å¤©\" onChange={(event) => setExceptWorkday(Number(event.target.value))} />\n            <Input style={{ width: '100px' }} value={exceptHoliDay} prefix=\"å‡æœŸ\" suffix=\"å¤©\" onChange={(event) => setExceptHoliDay(Number(event.target.value))} />\n          </span>\n        }\n\n        {isCycleTask &&\n          <Input style={{ width: '100px', marginLeft: \"15px\" }} value={cycleGap} placeholder=\"1è¡¨ç¤ºä¸é—´éš”\" prefix=\"æ¯\" suffix=\"å¤©\" onChange={(event) => setCycleGap(Number(event.target.value))} />\n        }\n\n      </Div>\n\n\n\n      <span style={{ backgroundColor: \"#ffffff\", padding: 2, margin: \"10px\" }} >\n        {getAllTaskStatus()}\n      </span>\n\n      <NoteList />\n    </Container>\n  );\n}\n\n\nconst NoteItem = styled.div`\n:hover{\n\t/* background-color:#b4e7fc; */\n  background-color: ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.choosed) {\n      return '#f5b52b'\n    } else {\n      return '#b4e7fc'\n    }\n  }\n  }\n};\nbackground-color: ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.choosed) {\n      return '#f5b52b'\n    } else {\n      return '#ffffff'\n    }\n  }\n  };\nopacity : ${(props: { choosed: boolean, isDone: boolean }) => {\n    if (props.isDone) {\n      return 0.15\n    } else {\n      return 1\n    }\n  }\n  };;\n`\nconst NoteList: React.FC = () => {\n  const { storeModel } = stores.useStore('mainmodel') as { storeModel: StoreModel };\n  const { currentTask, setCurrentTask } = stores.useStore(CurrentTaskKey) as { currentTask: Task | undefined, setCurrentTask: (note: Task) => void }\n  const { currentDoingTask, setCurrentDoingTask } = stores.useStore(CurrentDoingTaskKey) as { currentDoingTask: Task | undefined, setCurrentDoingTask: (note: Task | undefined) => void }\n  const { save } = stores.useStore('mainmodel') as { save: () => void };\n  const { currentDayOffset, setCurrentDayOffset } = stores.useStore(CurrentDayOffsetKey) as { currentDayOffset: number, setCurrentDayOffset: (offset: number) => void }\n\n  useEffect(() => {\n    // console.log(\"NoteList useEffect\")\n\n    if (currentDoingTask === undefined) {\n      let doingTasks = storeModel.tasks.filter((value) => { return value.isDoing() })\n\n      if (doingTasks.length === 0) {\n        return\n      }\n\n      if (doingTasks.length > 1) {\n        console.error(`æœ‰ ${doingTasks.length} ä¸ªä»»åŠ¡åœ¨è¿è¡Œä¸­ï¼Œè‡ªåŠ¨å…³é—­`)\n\n        for (let i = 1; i < doingTasks.length; i++) {\n          doingTasks[i].stop()\n        }\n      }\n\n      setCurrentDoingTask(doingTasks[0])\n    }\n  });\n\n  function onChooseNote(event: any, note: Task) {\n    event.preventDefault()\n    setCurrentTask(note)\n  }\n\n  const onClickMenu = (param: ClickParam, task: Task) => {\n    task.level = Number(param.key)\n\n    storeModel.orderTasks()\n    save()\n\n    param.domEvent.preventDefault()\n\n    // æ€ä¹ˆé˜»æ­¢å¯¹ parent çš„ç‚¹å‡»äº‹ä»¶\n    // param.domEvent.stopPropagation()\n  };\n\n  function getMenu(task: Task): React.ReactElement {\n    return (\n      <Menu onClick={(param) => onClickMenu(param, task)}>\n        <Menu.Item key=\"1\">ä¼˜å…ˆçº§ 1</Menu.Item>\n        <Menu.Item key=\"2\">ä¼˜å…ˆçº§ 2</Menu.Item>\n        <Menu.Item key=\"3\">ä¼˜å…ˆçº§ 3</Menu.Item>\n        <Menu.Item key=\"4\">ä¼˜å…ˆçº§ 4</Menu.Item>\n        <Menu.Item key=\"5\">ä¼˜å…ˆçº§ 5</Menu.Item>\n      </Menu>\n    )\n  }\n\n  function startTask(event: any, task: Task) {\n    if (task.isDone()) {\n      message.error(`ä»»åŠ¡å·²å®Œæˆï¼Œå®Œæˆæ—¶é—´:${Format.formatTimeInMs(task.doneTime)}`)\n      return\n    }\n\n    if (currentDoingTask != undefined && currentDoingTask.id === task.id) {\n      message.error(`ä»»åŠ¡å·²ç»åœ¨è¿›è¡Œä¸­ï¼Œä¸Šæ¬¡å¼€å§‹æ—¶é—´ï¼š${Format.formatTimeInMs(task.lastStartTime())}`)\n      return\n    }\n\n    if (task.isDoing()) {\n      // todo è‡ªåŠ¨æ¢å¤\n      message.error(`ä»»åŠ¡å¼‚å¸¸ä¸­æ–­ï¼Œé‡æ–°å¼€å§‹ã€‚ä¸Šæ¬¡å¼€å§‹æ—¶é—´ï¼š${Format.formatTimeInMs(task.lastStartTime())}`)\n    }\n\n    if (currentDoingTask != undefined) {\n      currentDoingTask.stop()\n    }\n\n    task.start()\n    setCurrentDoingTask(task)\n    storeModel.orderTasks()\n    save()\n  }\n\n  function getShowTips(task: Task): string {\n    let result = \"  \" + TaskInfoFormat.getDoingStatusTips(task) + TaskInfoFormat.getDeadline(task) + TaskInfoFormat.getConsumeExpected(task)\n    return result\n  }\n\n  return (\n    <Container2>\n      <List\n        size=\"small\"\n        style={{ backgroundColor: 'white', margin: \"1%\" }}\n        bordered\n        dataSource={storeModel.getTasks(DateUtils.getMyCurrentDayDur(currentDayOffset))}\n        renderItem={task => (\n          <NoteItem choosed={task.isSameTask(currentTask)} key={task.id} onClick={(e) => onChooseNote(e, task)} isDone={task.isDone()}>\n\n            <Row>\n              <Col flex=\"1 1 auto\">\n                <NoteItemInput key={task.id} task={task} />\n              </Col>\n              <Col flex=\"0 1 auto\">\n\n                {getShowTips(task)}\n                <Dropdown overlay={getMenu(task)}>\n                  <a style={{ paddingLeft: 5 }} className=\"ant-dropdown-link\" onClick={e => e.preventDefault()}>\n                    {formartLevel(task.level)} <DownOutlined />\n                  </a>\n                </Dropdown>\n\n                <Button onClick={(e) => startTask(e, task)}>Start</Button>\n\n              </Col>\n            </Row>\n\n          </NoteItem>\n        )}\n      />\n    </Container2>\n  );\n}\n\nfunction formartLevel(level: number): string {\n  switch (level) {\n    case 1:\n      return \"ğŸŒŸ\"\n    case 2:\n      return \"ğŸ\"\n    case 3:\n      return \"3ï¸âƒ£\"\n    case 4:\n      return \"4ï¸\"\n    case 5:\n      return \"5ï¸\"\n    default:\n      return \"\"\n  }\n\n  // switch (level) {\n  //   case 1:\n  //     return \"ğŸ¥‡\"\n  //   case 2:\n  //     return \"ğŸ¥ˆ\"\n  //   case 3:\n  //     return \"ğŸ¥‰\"\n  //   case 4:\n  //     return \"4ï¸âƒ£\"\n  //   case 5:\n  //     return \"5ï¸\"\n  //   default:\n  //     return \"\"\n  // }\n}\n\ninterface NoteItemInputProps {\n  task: Task;\n}\n\nconst NoteItemInput: React.FC<NoteItemInputProps> = (props) => {\n  const [content, setContent] = useState(props.task.title)\n  const { save } = stores.useStore('mainmodel') as { save: () => void };\n\n  function saveTaskTitle(event: any) {\n    props.task.title = content\n    save()\n  }\n\n  return (\n    <Input style={{ background: \"#ffffff70\", fontWeight: \"bold\" }} value={content} onChange={(e) => setContent(e.target.value)} onBlur={saveTaskTitle} />\n  );\n}\n\nexport default TaskListContainer;"]},"metadata":{},"sourceType":"module"}