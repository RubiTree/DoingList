{"ast":null,"code":"import{Task,StoreModel}from'../model/model';import'reflect-metadata';import'../../node_modules/reflect-metadata/Reflect.js';import{plainToClass}from\"class-transformer\";var STORAGE_KEY='DoingList3';var storage={isDebug:false,fetch:function fetch(){if(this.isDebug){return this._getMockStoreModel();}var result=new StoreModel();var storageJson=localStorage.getItem(STORAGE_KEY);if(storageJson!=null){result=plainToClass(StoreModel,JSON.parse(storageJson));result.tasks.forEach(function(task){task.adaptData();});return result;}return result;},save:function save(storeModel){localStorage.setItem(STORAGE_KEY,JSON.stringify(storeModel));},_getMockStoreModel:function _getMockStoreModel(){var result=new StoreModel();for(var index=0;index<12;index++){var newLocal=new Task();newLocal.init(\"我的第 \"+index+\" 个任务\");result.addTask(newLocal);}return result;}};var model={storeModel:storage.fetch(),save:function save(){storage.save(this.storeModel);},setModel:function setModel(model){this.storeModel=model;this.save();}};export default model;","map":{"version":3,"sources":["/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/src/stores/MainStore.ts"],"names":["Task","StoreModel","plainToClass","STORAGE_KEY","storage","isDebug","fetch","_getMockStoreModel","result","storageJson","localStorage","getItem","JSON","parse","tasks","forEach","task","adaptData","save","storeModel","setItem","stringify","index","newLocal","init","addTask","model","setModel"],"mappings":"AAAA,OAASA,IAAT,CAAyBC,UAAzB,KAA2C,gBAA3C,CAGA,MAAO,kBAAP,CACA,MAAO,gDAAP,CACA,OAASC,YAAT,KAA6B,mBAA7B,CAGA,GAAMC,CAAAA,WAAW,CAAG,YAApB,CACA,GAAMC,CAAAA,OAAO,CAAG,CACZC,OAAO,CAAE,KADG,CAEZC,KAAK,CAAE,gBAAwB,CAC3B,GAAI,KAAKD,OAAT,CAAkB,CACd,MAAO,MAAKE,kBAAL,EAAP,CACH,CAED,GAAIC,CAAAA,MAAM,CAAG,GAAIP,CAAAA,UAAJ,EAAb,CAEA,GAAIQ,CAAAA,WAAW,CAAGC,YAAY,CAACC,OAAb,CAAqBR,WAArB,CAAlB,CACA,GAAIM,WAAW,EAAI,IAAnB,CAAyB,CACrBD,MAAM,CAAGN,YAAY,CAACD,UAAD,CAAaW,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAb,CAArB,CACAD,MAAM,CAACM,KAAP,CAAaC,OAAb,CAAqB,SAACC,IAAD,CAAU,CAACA,IAAI,CAACC,SAAL,GAAiB,CAAjD,EACA,MAAOT,CAAAA,MAAP,CACH,CAED,MAAOA,CAAAA,MAAP,CACH,CAjBW,CAmBZU,IAAI,CAAE,cAAUC,UAAV,CAAkC,CACpCT,YAAY,CAACU,OAAb,CAAqBjB,WAArB,CAAkCS,IAAI,CAACS,SAAL,CAAeF,UAAf,CAAlC,EACH,CArBW,CAuBZZ,kBAvBY,8BAuBqB,CAC7B,GAAIC,CAAAA,MAAM,CAAG,GAAIP,CAAAA,UAAJ,EAAb,CAEA,IAAK,GAAIqB,CAAAA,KAAK,CAAG,CAAjB,CAAoBA,KAAK,CAAG,EAA5B,CAAgCA,KAAK,EAArC,CAAyC,CACrC,GAAMC,CAAAA,QAAQ,CAAG,GAAIvB,CAAAA,IAAJ,EAAjB,CACJuB,QAAQ,CAACC,IAAT,CAAc,OAASF,KAAT,CAAiB,MAA/B,EACId,MAAM,CAACiB,OAAP,CAAeF,QAAf,EACH,CAED,MAAOf,CAAAA,MAAP,CACH,CAjCW,CAAhB,CAoCA,GAAMkB,CAAAA,KAAK,CAAG,CACVP,UAAU,CAAEf,OAAO,CAACE,KAAR,EADF,CAGVY,IAHU,gBAGH,CACHd,OAAO,CAACc,IAAR,CAAa,KAAKC,UAAlB,EACH,CALS,CAOVQ,QAPU,mBAODD,KAPC,CAOkB,CACxB,KAAKP,UAAL,CAAkBO,KAAlB,CACA,KAAKR,IAAL,GACH,CAVS,CAAd,CAaA,cAAeQ,CAAAA,KAAf","sourcesContent":["import { Task, Duration, StoreModel } from '../model/model'\nimport Utils from '../utils/Utils';\nimport stores from '../stores';\nimport 'reflect-metadata'\nimport '../../node_modules/reflect-metadata/Reflect.js'\nimport { plainToClass } from \"class-transformer\";\n\n\nconst STORAGE_KEY = 'DoingList3'\nconst storage = {\n    isDebug: false,\n    fetch: function (): StoreModel {\n        if (this.isDebug) {\n            return this._getMockStoreModel()\n        }\n\n        let result = new StoreModel()\n\n        let storageJson = localStorage.getItem(STORAGE_KEY)\n        if (storageJson != null) {\n            result = plainToClass(StoreModel, JSON.parse(storageJson))\n            result.tasks.forEach((task) => {task.adaptData()})\n            return result\n        }\n        \n        return result\n    },\n\n    save: function (storeModel: StoreModel) {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(storeModel))\n    },\n\n    _getMockStoreModel(): StoreModel {\n        let result = new StoreModel()\n\n        for (let index = 0; index < 12; index++) {\n            const newLocal = new Task();\n        newLocal.init(\"我的第 \" + index + \" 个任务\")\n            result.addTask(newLocal)\n        }\n\n        return result\n    },\n}\n\nconst model = {\n    storeModel: storage.fetch(),\n\n    save() {\n        storage.save(this.storeModel)\n    },\n\n    setModel(model: StoreModel) {\n        this.storeModel = model\n        this.save()\n    },\n};\n\nexport default model"]},"metadata":{},"sourceType":"module"}