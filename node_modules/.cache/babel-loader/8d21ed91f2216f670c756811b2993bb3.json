{"ast":null,"code":"import{Task,StoreModel}from'../model/model';import'reflect-metadata';import'../../node_modules/reflect-metadata/Reflect.js';import{plainToClass}from\"class-transformer\";var STORAGE_KEY='DoingList3';var storage={isDebug:false,fetch:function fetch(){if(this.isDebug){return this._getMockStoreModel();}var result=new StoreModel();var storageJson=localStorage.getItem(STORAGE_KEY);if(storageJson!=null){return plainToClass(StoreModel,JSON.parse(storageJson));}return result;},save:function save(storeModel){localStorage.setItem(STORAGE_KEY,JSON.stringify(storeModel));},_getMockStoreModel:function _getMockStoreModel(){var result=new StoreModel();for(var index=0;index<12;index++){var newLocal=new Task();newLocal.init(\"我的第 \"+index+\" 个任务\");result.addTask(newLocal);}return result;}};var model={storeModel:storage.fetch(),save:function save(){storage.save(this.storeModel);},setModel:function setModel(model){this.storeModel=model;this.save();}};export default model;","map":{"version":3,"sources":["/Users/bear/Develop/vscode/self/study/study1/React/DoingList/doinglist2/src/stores/MainStore.ts"],"names":["Task","StoreModel","plainToClass","STORAGE_KEY","storage","isDebug","fetch","_getMockStoreModel","result","storageJson","localStorage","getItem","JSON","parse","save","storeModel","setItem","stringify","index","newLocal","init","addTask","model","setModel"],"mappings":"AAAA,OAASA,IAAT,CAAyBC,UAAzB,KAA2C,gBAA3C,CAGA,MAAO,kBAAP,CACA,MAAO,gDAAP,CACA,OAASC,YAAT,KAA6B,mBAA7B,CAGA,GAAMC,CAAAA,WAAW,CAAG,YAApB,CACA,GAAMC,CAAAA,OAAO,CAAG,CACZC,OAAO,CAAE,KADG,CAEZC,KAAK,CAAE,gBAAwB,CAC3B,GAAI,KAAKD,OAAT,CAAkB,CACd,MAAO,MAAKE,kBAAL,EAAP,CACH,CAED,GAAIC,CAAAA,MAAM,CAAG,GAAIP,CAAAA,UAAJ,EAAb,CAEA,GAAIQ,CAAAA,WAAW,CAAGC,YAAY,CAACC,OAAb,CAAqBR,WAArB,CAAlB,CACA,GAAIM,WAAW,EAAI,IAAnB,CAAyB,CACrB,MAAOP,CAAAA,YAAY,CAACD,UAAD,CAAaW,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAb,CAAnB,CACH,CAED,MAAOD,CAAAA,MAAP,CACH,CAfW,CAiBZM,IAAI,CAAE,cAAUC,UAAV,CAAkC,CACpCL,YAAY,CAACM,OAAb,CAAqBb,WAArB,CAAkCS,IAAI,CAACK,SAAL,CAAeF,UAAf,CAAlC,EACH,CAnBW,CAqBZR,kBArBY,8BAqBqB,CAC7B,GAAIC,CAAAA,MAAM,CAAG,GAAIP,CAAAA,UAAJ,EAAb,CAEA,IAAK,GAAIiB,CAAAA,KAAK,CAAG,CAAjB,CAAoBA,KAAK,CAAG,EAA5B,CAAgCA,KAAK,EAArC,CAAyC,CACrC,GAAMC,CAAAA,QAAQ,CAAG,GAAInB,CAAAA,IAAJ,EAAjB,CACJmB,QAAQ,CAACC,IAAT,CAAc,OAASF,KAAT,CAAiB,MAA/B,EACIV,MAAM,CAACa,OAAP,CAAeF,QAAf,EACH,CAED,MAAOX,CAAAA,MAAP,CACH,CA/BW,CAAhB,CAkCA,GAAMc,CAAAA,KAAK,CAAG,CACVP,UAAU,CAAEX,OAAO,CAACE,KAAR,EADF,CAGVQ,IAHU,gBAGH,CACHV,OAAO,CAACU,IAAR,CAAa,KAAKC,UAAlB,EACH,CALS,CAOVQ,QAPU,mBAODD,KAPC,CAOkB,CACxB,KAAKP,UAAL,CAAkBO,KAAlB,CACA,KAAKR,IAAL,GACH,CAVS,CAAd,CAaA,cAAeQ,CAAAA,KAAf","sourcesContent":["import { Task, Duration, StoreModel } from '../model/model'\nimport Utils from '../utils/Utils';\nimport stores from '../stores';\nimport 'reflect-metadata'\nimport '../../node_modules/reflect-metadata/Reflect.js'\nimport { plainToClass } from \"class-transformer\";\n\n\nconst STORAGE_KEY = 'DoingList3'\nconst storage = {\n    isDebug: false,\n    fetch: function (): StoreModel {\n        if (this.isDebug) {\n            return this._getMockStoreModel()\n        }\n\n        let result = new StoreModel()\n\n        let storageJson = localStorage.getItem(STORAGE_KEY)\n        if (storageJson != null) {\n            return plainToClass(StoreModel, JSON.parse(storageJson))\n        }\n\n        return result\n    },\n\n    save: function (storeModel: StoreModel) {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(storeModel))\n    },\n\n    _getMockStoreModel(): StoreModel {\n        let result = new StoreModel()\n\n        for (let index = 0; index < 12; index++) {\n            const newLocal = new Task();\n        newLocal.init(\"我的第 \" + index + \" 个任务\")\n            result.addTask(newLocal)\n        }\n\n        return result\n    },\n}\n\nconst model = {\n    storeModel: storage.fetch(),\n\n    save() {\n        storage.save(this.storeModel)\n    },\n\n    setModel(model: StoreModel) {\n        this.storeModel = model\n        this.save()\n    },\n};\n\nexport default model"]},"metadata":{},"sourceType":"module"}